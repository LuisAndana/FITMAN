<div class="wrap">
  <!-- Back -->
  <a routerLink="/nutriologos" class="back-btn" aria-label="Volver a la lista">
    <span>â†</span> Volver
  </a>

  <!-- Skeleton mientras carga -->
  <section *ngIf="loading" class="hero skeleton">
    <div class="s-line l1"></div>
    <div class="s-line l2"></div>
    <div class="s-line l3"></div>
  </section>

  <!-- Contenido -->
  <section *ngIf="!loading && data" class="hero">
    <div class="hero-inner">
      <!-- Avatar + nombre -->
      <div class="id-block">
        <div class="avatar" aria-hidden="true">
          {{ (data.nombre || 'N')[0] | uppercase }}
        </div>

        <div>
          <div class="title-row">
            <h1 class="title">{{ data.nombre || 'NutriÃ³logo' }}</h1>
            <span *ngIf="data.validado" class="badge-ok">âœ“ Validado</span>
          </div>
          <p class="subtitle">
            {{ data.profesion || 'ProfesiÃ³n no especificada' }}
          </p>
          <p class="meta">CÃ©dula: {{ data.numero_cedula_mask || '****' }}</p>
        </div>
      </div>

      <!-- Acciones principales -->
      <div class="cta-row">
        <!-- ğŸ‘‰ BOTÃ“N PRINCIPAL: CONTRATAR -->
        <button 
          class="btn primary hire-btn" 
          type="button" 
          (click)="hireNutritionist()"
          [disabled]="!userAuthenticated">
          ğŸ’³ Contratar NutriÃ³logo
        </button>

        <!-- BotÃ³n secundario: Ver ReseÃ±as -->
        <button
          class="btn ghost"
          type="button"
          (click)="openResenas()">
          â­ Ver ReseÃ±as
        </button>

        <!-- Botones adicionales -->
        <a *ngIf="data.documento_url"
           class="btn ghost"
           [href]="data.documento_url"
           target="_blank" rel="noopener">
          ğŸ“„ Ver documento
        </a>
        
        <button class="btn outline" type="button" (click)="sendMessage()">
          ğŸ’¬ Enviar mensaje
        </button>
      </div>

      <!-- BotÃ³n para crear reseÃ±a (si estÃ¡ autenticado y es cliente) -->
      <button
        *ngIf="userAuthenticated && !isNutriologo"
        class="btn-create-resena"
        type="button"
        (click)="openFormResena()">
        âœï¸ Crear reseÃ±a
      </button>

      <!-- Aviso si no estÃ¡ autenticado -->
      <p class="auth-hint" *ngIf="!userAuthenticated">
        Debes <a routerLink="/login" class="link-highlight">iniciar sesiÃ³n</a> para contratar un nutriÃ³logo
      </p>
    </div>
  </section>

  <!-- Cards informativas (matching Home) -->
  <div class="cards">
    <article class="card">
      <div class="icon">ğŸ</div>
      <h3>Plan Nutricional</h3>
      <p>
        ElaboraciÃ³n de planes personalizados basados en tus objetivos y
        estilo de vida.
      </p>
    </article>

    <article class="card">
      <div class="icon">ğŸ“…</div>
      <h3>Seguimiento</h3>
      <p>
        Sesiones de seguimiento para ajustar tu plan y medir tu progreso.
      </p>
    </article>

    <article class="card">
      <div class="icon">ğŸ’¬</div>
      <h3>AsesorÃ­a</h3>
      <p>
        ResoluciÃ³n de dudas sobre alimentaciÃ³n, hÃ¡bitos y suplementaciÃ³n.
      </p>
    </article>
  </div>
</div>

<!-- ğŸ”´ CORRECCIÃ“N IMPORTANTE:
     Cambio de selector: app-resenas-modal â†’ app-resena-modal
     El componente se llama ResenaModalComponent, no ResenaModalComponent
-->

<!-- Modal: Mostrar ReseÃ±as -->
<app-resena-modal
  [nutriologoId]="data?.id_usuario"
  [isOpen]="showResenas"
  (closed)="closeResenas()">
</app-resena-modal>

<!-- Modal: Crear ReseÃ±a -->
<app-resena-form
  [nutriologoId]="data?.id_usuario"
  [isOpen]="showFormResena"
  (success)="onResenaCreated()"
  (close)="closeFormResena()">
</app-resena-form>