<div class="pago-container fade-in">

  <div class="pago-card slide-up">

    <h1>Procesar Pago</h1>

    <!-- Cargando -->
    <div *ngIf="cargando" class="loading fade-in">
      <p>Cargando información del pago...</p>
    </div>

    <!-- Error -->
    <div *ngIf="error && !cargando" class="error-message shake">
      {{ error }}
    </div>

    <div *ngIf="contrato && !cargando" class="pago-content">

      <!-- Resumen -->
      <section class="resumen glass">
        <h2>Resumen del Contrato</h2>

        <div class="resumen-item">
          <span>Nutriólogo:</span>
          <span>{{ contrato.nutriologo_nombre }}</span>
        </div>

        <div class="resumen-item">
          <span>Monto mensual:</span>
          <span>${{ contrato.monto }}</span>
        </div>

        <div class="resumen-item">
          <span>Duración:</span>
          <span>{{ contrato.duracion_meses }} mes{{ contrato.duracion_meses !== 1 ? 'es' : '' }}</span>
        </div>

        <div class="resumen-item total highlight">
          <span>Total:</span>
          <span>${{ contrato.monto * contrato.duracion_meses }}</span>
        </div>
      </section>

      <!-- Formulario -->
      <form [formGroup]="form" (ngSubmit)="procesarPago()" class="pago-form">

        <div class="form-group">
          <label>Tarjeta</label>
          <div id="card-element" class="card-element shadow-sm"></div>

          <div *ngIf="errorTarjeta" class="error-message">
            {{ errorTarjeta }}
          </div>
        </div>

        <div class="form-group">
          <label>Email</label>
          <input formControlName="email" class="form-input" type="email" placeholder="correo@example.com">
        </div>

        <div class="form-group">
          <label>Nombre</label>
          <input formControlName="nombre" class="form-input" type="text" placeholder="Tu nombre completo">
        </div>

        <button type="submit" class="btn-pagar glow" [disabled]="form.invalid || procesandoPago">
          {{ procesandoPago ? 'Procesando...' : 'Pagar Ahora' }}
        </button>
      </form>

    </div>
  </div>

  <!-- MODAL DE ÉXITO -->
  <div *ngIf="pagoExitoso" class="modal-overlay fade-in">
    <div class="modal-card bounce-in">

      <div class="modal-icon">✓</div>

      <h2>Pago Exitoso</h2>
      <p>Tu contrato ha sido activado correctamente.</p>

      <button class="btn-success-modal" (click)="irAlDashboard()">Ir al Dashboard</button>
    </div>
  </div>

</div>
